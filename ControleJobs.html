<!DOCTYPE html>
<html>
	
	<head>
		<meta charset="UTF-8">
		<title>Controle de Jobs</title>
	</head>
	
	<body>
		<script>
			
			var job1 = {id:'01'
				         ,descricao:'Importação de arquivos de fundos'
				         ,dataMaximaConclusao:'2019-11-10 12:00:00'
				         ,tempoEstimado:2
				         };

			var job2 = {id:'02'
				         ,descricao:'Job 2'
				         ,dataMaximaConclusao:'2019-11-11 12:00:00'
				         ,tempoEstimado:6
				         };


			var job3 = {id:'03'
				         ,descricao:'Importação de arquivos de fundos'
				         ,dataMaximaConclusao:'2019-11-11 8:00:00'
				         ,tempoEstimado:8
				         };

      var inicioJanela = '2019-11-10 09:00:00';
      var fimJanela    = '2019-11-11 12:00:00';
			var schedule     = [job1, job2, job3];
      
      var conjuntosExecucao = [];
      var ixConjunto = 0; 
      
      conjuntosExecucao = getSchedule(schedule, inicioJanela, fimJanela);
      
      for (conjunto of conjuntosExecucao) {     	
          ixConjunto = ixConjunto + 1;
          alert('ID Jobs conjunto de execução ' + ixConjunto.toString().padStart(2, '0') + ' = ' + conjunto);
      }    
      
			function getSchedule(schedule, inicioJanela, fimJanela){
				conjunto = [];
				retorno = [];
			  tempoTotal = 0;
			  ixConjunto = 0;
				
				for (job of schedule) {
   	      	 tempoTotal = tempoTotal + job.tempoEstimado;
			      
			      if (tempoTotal > 8) {
     	          retorno.push(conjunto);
        				conjunto = [];
        				
			      } 			      	
 	          conjunto.push(job.id);
			  }	
        retorno.push(conjunto);
			  
			  return retorno;
			}
			
			
		</script>
		
		<form name = "ConsultaSchedule">
		
		</form>
	
	</body>
	
</html>